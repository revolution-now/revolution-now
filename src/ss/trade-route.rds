# ===============================================================
# trade-route.rds
#
# Project: Revolution Now
#
# Created by David P. Sicilia on 2025-10-25.
#
# Description: Rds definitions for the ss/trade-route module.
#
# ===============================================================
# ss
include "commodity.rds.hpp"
include "trade-route-id.hpp"
include "colony-id.hpp"

# C++ standard library
include "<map>"
include "<string>"
include "<vector>"

namespace "rn"

enum.e_trade_route_type {
  land,
  sea,
}

sumtype.TradeRouteTarget {
  harbor {},
  colony {
    colony_id 'ColonyId',
  },

  _features { equality, validation }
}

struct.TradeRouteStop {
  target 'TradeRouteTarget',

  # NOTE: in the OG there is a maximum of six here. We don't need
  # to impose that, but we might for compatibility.
  loads 'std::vector<e_commodity>',

  # NOTE: in the OG there is a maximum of six here. We don't need
  # to impose that, but we might for compatibility.
  unloads 'std::vector<e_commodity>',
}

struct.TradeRoute {
  # Must be >= 1.
  id 'TradeRouteId',

  # NOTE: in the OG this is a max of 32 chars.
  name 'std::string',

  type 'e_trade_route_type',

  # NOTE: in the OG this has a maximum of four stops.
  stops 'std::vector<TradeRouteStop>',

  _features { equality, validation }
}

struct.TradeRouteState {
  # Trade route IDs must be >= 1, so we store this as "previous"
  # so that the default value of zero is a valid value: it means
  # that no trade routes have yet been created. If we were to
  # store "next" then it would have to be at least one.
  #
  # Note that this also effectively gives the total number of
  # trade routes that have ever been created since the start of
  # the game.
  prev_trade_route_id 'TradeRouteId',

  # NOTE: in the OG there are a maximum of 12 trade routes.
  routes 'std::map<TradeRouteId, TradeRoute>',

  _features { equality, validation }
}
