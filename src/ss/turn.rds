# ===============================================================
# sg-turn.rds
#
# Project: Revolution Now
#
# Created by dsicilia on 2022-02-12.
#
# Description: Turn-related save-game state.
#
# ===============================================================
# Revolution Now
include "unit-id.hpp"

# Rds
include "nation.rds.hpp"

# base
include "base/maybe.hpp"

# C++ standard library
include "<deque>"

namespace "rn"

enum.e_season {
  winter,
  spring,
  summer,
  autumn,
}

struct.TurnTimePoint {
  year 'int',
  season 'e_season',

  # Total number of turns since the start of the game.
  turns 'int',

  _features { validation, equality }
}

sumtype.NationTurnState {
  not_started {},
  colonies {},
  units {
    q 'std::deque<UnitId>',
    skip_eot 'bool',
  },
  eot {},
  finish {},
  finished {},
}

sumtype.TurnCycle {
  not_started {}, # should be first.
  natives {},
  nation {
    nation 'e_nation',
    st 'NationTurnState',
  },
  end_cycle {},
  finished {},
}

struct.TurnState {
  time_point 'TurnTimePoint',
  cycle 'TurnCycle',
}
