# ===============================================================
# ref.rds
#
# Project: Revolution Now
#
# Created by David P. Sicilia on 2025-05-18.
#
# Description: Rds definitions for the ref module.
#
# ===============================================================
# ss
include "ss/colony-enums.rds.hpp"
include "ss/colony-id.hpp"
include "ss/unit-id.hpp"
include "ss/unit-type.rds.hpp"

# gfx
include "gfx/cartesian.hpp"

# base
include "base/maybe.hpp"

namespace "rn"

struct.RoyalMoneyChange {
  old_value 'int',
  per_turn_increase 'int',
  new_value 'int',
  new_unit_produced 'bool',
  amount_subtracted 'int',
}

struct.RefLandingTile {
  tile 'gfx::point',
  captured_units 'std::vector<GenericUnitId>',
}

struct.RefColonyLandingTiles {
  ship_tile 'RefLandingTile',
  landings 'std::vector<RefLandingTile>',
}

struct.RefColonySelectionMetrics {
  colony_id 'ColonyId',

  # Military
  defense_strength 'int',
  barricade 'e_colony_barricade_type',
  population 'int',

  # Geography
  eligible_landings 'std::vector<RefColonyLandingTiles>',
}

struct.RefColonyMetricsScored {
  metrics 'RefColonySelectionMetrics',
  score 'int',
}

enum.e_ref_landing_formation {
  _2_2_2,
  _4_1_1,
  _3_1_1,
  _2_1_1,
  _1_1_1,
  _2_1_0,
  _3_0_0,
}

enum.e_ref_manowar_availability {
  # There are none in stock or on the map, and we are not per-
  # mitted to regenerate ships, so we are done.
  none,
  # There are none in stock or on the map, and we are permitted
  # to regenerate ships, and we should add one to the stock.
  none_but_can_add,
  # There is none in stock but there are ships on the map that
  # could be returned to europe for re-use.
  available_on_map,
  # There is a ship in stock available for immediate use.
  available_in_stock,
}

struct.RefLandingForce {
  regular   'int',
  cavalry   'int',
  artillery 'int',
}

struct.RefLandingPlan {
  ship_tile 'RefLandingTile',
  landing_units 'std::vector<std::pair<e_unit_type, RefLandingTile>>',
}

struct.RefLandedUnit {
  unit_id 'UnitId',
  landing_tile 'RefLandingTile',
}

struct.RefLandingUnits {
  colony_id 'ColonyId',
  ship 'RefLandedUnit',
  landed_units 'std::vector<RefLandedUnit>',
}

enum.e_forfeight_reason {
  no_more_land_units_in_stock,
  no_more_ships,
}

enum.e_ref_win_reason {
  port_colonies_captured,
  ref_controls_90_percent_population,
}
